From a8ec1d746ed41ac76df2e28cbc5683b3e37b9a60 Mon Sep 17 00:00:00 2001
From: Jiri Denemark <jdenemar@redhat.com>
Date: Thu, 26 Mar 2020 15:07:42 +0100
Subject: [PATCH] cpu_x86: Move and rename x86ModelCopySignatures
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Later in this series the function will work on a newly introduced
virCPUx86Signatures structure. Let's move it to the place were all
related functions will be added and rename the function as
virCPUx86SignaturesCopy for easier review of the virCPUx86Signatures
patch.

Signed-off-by: Jiri Denemark <jdenemar@redhat.com>
Reviewed-by: JÃ¡n Tomko <jtomko@redhat.com>

Origin: upstream, https://libvirt.org/git/?p=libvirt.git;a=commit;h=a8ec1d746e
Bug-Ubuntu: https://bugs.launchpad.net/ubuntu/+source/libvirt/+bug/1922907
Last-Update: 2021-04-07

---
 src/cpu/cpu_x86.c | 36 ++++++++++++++++++------------------
 1 file changed, 18 insertions(+), 18 deletions(-)

diff --git a/src/cpu/cpu_x86.c b/src/cpu/cpu_x86.c
index f40609f7e4..50ee9408e6 100644
--- a/src/cpu/cpu_x86.c
+++ b/src/cpu/cpu_x86.c
@@ -1090,23 +1090,9 @@ x86FeatureParse(xmlXPathContextPtr ctxt,
 }
 
 
-static void
-x86ModelFree(virCPUx86ModelPtr model)
-{
-    if (!model)
-        return;
-
-    g_free(model->name);
-    g_free(model->signatures);
-    virCPUx86DataClear(&model->data);
-    g_free(model);
-}
-G_DEFINE_AUTOPTR_CLEANUP_FUNC(virCPUx86Model, x86ModelFree);
-
-
 static int
-x86ModelCopySignatures(virCPUx86ModelPtr dst,
-                       virCPUx86ModelPtr src)
+virCPUx86SignaturesCopy(virCPUx86ModelPtr dst,
+                        virCPUx86ModelPtr src)
 {
     size_t i;
 
@@ -1124,6 +1110,20 @@ x86ModelCopySignatures(virCPUx86ModelPtr dst,
 }
 
 
+static void
+x86ModelFree(virCPUx86ModelPtr model)
+{
+    if (!model)
+        return;
+
+    g_free(model->name);
+    g_free(model->signatures);
+    virCPUx86DataClear(&model->data);
+    g_free(model);
+}
+G_DEFINE_AUTOPTR_CLEANUP_FUNC(virCPUx86Model, x86ModelFree);
+
+
 static virCPUx86ModelPtr
 x86ModelCopy(virCPUx86ModelPtr model)
 {
@@ -1132,7 +1132,7 @@ x86ModelCopy(virCPUx86ModelPtr model)
     copy = g_new0(virCPUx86Model, 1);
     copy->name = g_strdup(model->name);
 
-    if (x86ModelCopySignatures(copy, model) < 0) {
+    if (virCPUx86SignaturesCopy(copy, model) < 0) {
         x86ModelFree(copy);
         return NULL;
     }
@@ -1360,7 +1360,7 @@ x86ModelParseAncestor(virCPUx86ModelPtr model,
     }
 
     model->vendor = ancestor->vendor;
-    if (x86ModelCopySignatures(model, ancestor) < 0)
+    if (virCPUx86SignaturesCopy(model, ancestor) < 0)
         return -1;
 
     x86DataCopy(&model->data, &ancestor->data);
-- 
2.31.1

