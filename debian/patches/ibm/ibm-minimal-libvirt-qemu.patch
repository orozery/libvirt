--- a/src/security/apparmor/libvirt-qemu
+++ b/src/security/apparmor/libvirt-qemu
@@ -13,9 +13,9 @@
   capability setgid,
   capability setuid,
 
-  # for 9p
-  capability fsetid,
-  capability fowner,
+  # for 9p ????
+  # capability fsetid,
+  # capability fowner,
 
   network inet stream,
   network inet6 stream,
@@ -29,6 +29,8 @@
   /dev/net/tun rw,
   /dev/kvm rw,
   /dev/ptmx rw,
+  # /dev/kqemu rw,
+  /dev/vhost-net rw,
   @{PROC}/*/status r,
   # When qemu is signaled to terminate, it will read cmdline of signaling
   # process for reporting purposes. Allowing read access to a process
@@ -42,12 +44,12 @@
   @{PROC}/sys/vm/overcommit_memory r,
 
   # For hostdev access. The actual devices will be added dynamically
-  /sys/bus/usb/devices/ r,
-  /sys/devices/**/usb[0-9]*/** r,
+  # /sys/bus/usb/devices/ r,
+  # /sys/devices/**/usb[0-9]*/** r,
   # libusb needs udev data about usb devices (~equal to content of lsusb -v)
-  /run/udev/data/c16[6,7]* r,
-  /run/udev/data/c18[0,8,9]* r,
-  /run/udev/data/+usb* r,
+  # /run/udev/data/c16[6,7]* r,
+  # /run/udev/data/c18[0,8,9]* r,
+  # /run/udev/data/+usb* r,
 
   # WARNING: this gives the guest direct access to host hardware and specific
   # portions of shared memory. This is required for sound using ALSA with kvm,
@@ -68,31 +70,31 @@
   # Uncomment the following if you need access to /dev/fb*
   #/dev/fb* rw,
 
-  /etc/pulse/client.conf r,
-  @{HOME}/.pulse-cookie rwk,
-  owner /root/.pulse-cookie rwk,
-  owner /root/.pulse/ rw,
-  owner /root/.pulse/* rw,
-  /usr/share/alsa/** r,
-  owner /tmp/pulse-*/ rw,
-  owner /tmp/pulse-*/* rw,
-  /var/lib/dbus/machine-id r,
+  # /etc/pulse/client.conf r,
+  # @{HOME}/.pulse-cookie rwk,
+  # owner /root/.pulse-cookie rwk,
+  # owner /root/.pulse/ rw,
+  # owner /root/.pulse/* rw,
+  # /usr/share/alsa/** r,
+  # owner /tmp/pulse-*/ rw,
+  # owner /tmp/pulse-*/* rw,
+  # /var/lib/dbus/machine-id r,
 
   # access to firmware's etc
-  /usr/share/kvm/** r,
+  # /usr/share/kvm/** r,
   /usr/share/qemu/** r,
-  /usr/share/qemu-kvm/** r,
-  /usr/share/bochs/** r,
-  /usr/share/openbios/** r,
-  /usr/share/openhackware/** r,
-  /usr/share/proll/** r,
-  /usr/share/vgabios/** r,
+  # /usr/share/qemu-kvm/** r,
+  # /usr/share/bochs/** r,
+  # /usr/share/openbios/** r,
+  # /usr/share/openhackware/** r,
+  # /usr/share/proll/** r,
+  # /usr/share/vgabios/** r,
   /usr/share/seabios/** r,
-  /usr/share/misc/sgabios.bin r,
-  /usr/share/ovmf/** r,
-  /usr/share/OVMF/** r,
-  /usr/share/AAVMF/** r,
-  /usr/share/qemu-efi/** r,
+  # /usr/share/misc/sgabios.bin r,
+  # /usr/share/ovmf/** r,
+  # /usr/share/OVMF/** r,
+  # /usr/share/AAVMF/** r,
+  # /usr/share/qemu-efi/** r,
   /usr/share/slof/** r,
 
   # pki for libvirt-vnc and libvirt-spice (LP: #901272, #1690140)
@@ -104,70 +106,11 @@
   /etc/pki/qemu/** r,
 
   # the various binaries
-  /usr/bin/kvm rmix,
-  /usr/bin/qemu rmix,
-  /usr/bin/qemu-kvm rmix,
-  /usr/bin/qemu-system-aarch64 rmix,
-  /usr/bin/qemu-system-alpha rmix,
-  /usr/bin/qemu-system-arm rmix,
-  /usr/bin/qemu-system-cris rmix,
-  /usr/bin/qemu-system-hppa rmix,
   /usr/bin/qemu-system-i386 rmix,
-  /usr/bin/qemu-system-lm32 rmix,
-  /usr/bin/qemu-system-m68k rmix,
-  /usr/bin/qemu-system-microblaze rmix,
-  /usr/bin/qemu-system-microblazeel rmix,
-  /usr/bin/qemu-system-mips rmix,
-  /usr/bin/qemu-system-mips64 rmix,
-  /usr/bin/qemu-system-mips64el rmix,
-  /usr/bin/qemu-system-mipsel rmix,
-  /usr/bin/qemu-system-moxie rmix,
-  /usr/bin/qemu-system-nios2 rmix,
-  /usr/bin/qemu-system-or1k rmix,
-  /usr/bin/qemu-system-or32 rmix,
-  /usr/bin/qemu-system-ppc rmix,
   /usr/bin/qemu-system-ppc64 rmix,
-  /usr/bin/qemu-system-ppcemb rmix,
-  /usr/bin/qemu-system-riscv32 rmix,
-  /usr/bin/qemu-system-riscv64 rmix,
   /usr/bin/qemu-system-s390x rmix,
-  /usr/bin/qemu-system-sh4 rmix,
-  /usr/bin/qemu-system-sh4eb rmix,
-  /usr/bin/qemu-system-sparc rmix,
-  /usr/bin/qemu-system-sparc64 rmix,
-  /usr/bin/qemu-system-tricore rmix,
-  /usr/bin/qemu-system-unicore32 rmix,
   /usr/bin/qemu-system-x86_64 rmix,
-  /usr/bin/qemu-system-xtensa rmix,
-  /usr/bin/qemu-system-xtensaeb rmix,
-  /usr/bin/qemu-aarch64 rmix,
-  /usr/bin/qemu-alpha rmix,
-  /usr/bin/qemu-arm rmix,
-  /usr/bin/qemu-armeb rmix,
-  /usr/bin/qemu-cris rmix,
-  /usr/bin/qemu-i386 rmix,
-  /usr/bin/qemu-m68k rmix,
-  /usr/bin/qemu-microblaze rmix,
-  /usr/bin/qemu-microblazeel rmix,
-  /usr/bin/qemu-mips rmix,
-  /usr/bin/qemu-mips64 rmix,
-  /usr/bin/qemu-mips64el rmix,
-  /usr/bin/qemu-mipsel rmix,
-  /usr/bin/qemu-mipsn32 rmix,
-  /usr/bin/qemu-mipsn32el rmix,
-  /usr/bin/qemu-or32 rmix,
-  /usr/bin/qemu-ppc rmix,
-  /usr/bin/qemu-ppc64 rmix,
-  /usr/bin/qemu-ppc64abi32 rmix,
-  /usr/bin/qemu-ppc64le rmix,
-  /usr/bin/qemu-s390x rmix,
-  /usr/bin/qemu-sh4 rmix,
-  /usr/bin/qemu-sh4eb rmix,
-  /usr/bin/qemu-sparc rmix,
-  /usr/bin/qemu-sparc32plus rmix,
-  /usr/bin/qemu-sparc64 rmix,
-  /usr/bin/qemu-unicore32 rmix,
-  /usr/bin/qemu-x86_64 rmix,
+
   # for Debian/Ubuntu qemu-block-extra / RPMs qemu-block-* (LP: #1554761)
   /usr/{lib,lib64}/qemu/*.so mr,
   /usr/lib/@{multiarch}/qemu/*.so mr,
@@ -178,9 +121,9 @@
   audit deny /{var/,}run/qemu/*/*.so w,
 
   # swtpm
-  /{usr/,}bin/swtpm rmix,
-  /usr/{lib,lib64}/libswtpm_libtpms.so mr,
-  /usr/lib/@{multiarch}/libswtpm_libtpms.so mr,
+  # /{usr/,}bin/swtpm rmix,
+  # /usr/{lib,lib64}/libswtpm_libtpms.so mr,
+  # /usr/lib/@{multiarch}/libswtpm_libtpms.so mr,
 
   # for save and resume
   /{usr/,}bin/dash rmix,
@@ -191,13 +134,14 @@
   /{usr/,}bin/bash rmix,
 
   # for usb access
-  /dev/bus/usb/ r,
-  /etc/udev/udev.conf r,
-  /sys/bus/ r,
-  /sys/class/ r,
+  #/dev/bus/usb/ r,
+  # /etc/udev/udev.conf r,
+  # /sys/bus/ r,
+  # /sys/class/ r,
 
   # for rbd
   /etc/ceph/ceph.conf r,
+  /run/ceph/rbd-client-*.asok rw,
 
   # Various functions will need to enumerate /tmp (e.g. ceph), allow the base
   # dir and a few known functions like samba support.
@@ -221,19 +165,18 @@
   /sys/firmware/devicetree/** r,
 
   # allow connect with openGraphicsFD to work
-  unix (send, receive) type=stream addr=none peer=(label=libvirtd),
-  unix (send, receive) type=stream addr=none peer=(label=/usr/sbin/libvirtd),
+  # unix (send, receive) type=stream addr=none peer=(label=/usr/sbin/libvirtd),
 
-  # allow access to charm-specific ceph config (LP: #1403648).
-  # No more silencing spurious denials as it can more critically hide other issues (LP: #1719579)
-  # Also allow the optional asok key that might be enabled by the charm (LP: #1779674)
-  /var/lib/charm/*/ceph.conf r,
-  /run/ceph/rbd-client-*.asok rw,
+  # allow access to charm-specific ceph config and silence spurious
+  # denials (LP: #1403648).
+  # /var/lib/charm/*/ceph.conf r,
+  deny /tmp/{,**} r,
+  deny /var/tmp/{,**} r,
 
   # kvm.powerpc executes/accesses this
-  /{usr/,}bin/uname rmix,
-  /{usr/,}sbin/ppc64_cpu rmix,
-  /{usr/,}bin/grep rmix,
+  /bin/uname rmix,
+  /usr/sbin/ppc64_cpu rmix,
+  /bin/grep rmix,
   /sys/devices/system/cpu/subcores_per_core r,
   /sys/devices/system/cpu/cpu*/online r,
 
@@ -250,11 +193,6 @@
   # for vfio hotplug on systems without static vfio (LP: #1775777)
   /dev/vfio/vfio rw,
 
-  # for vhost-net/vsock/scsi hotplug (LP: #1815910)
-  /dev/vhost-net rw,
-  /dev/vhost-vsock rw,
-  /dev/vhost-scsi rw,
-
   # required for sasl GSSAPI plugin
   /etc/gss/mech.d/ r,
   /etc/gss/mech.d/* r,
